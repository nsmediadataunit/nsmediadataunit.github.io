{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../LayerCake.svelte",
    "../../Html.svelte",
    "../../ScaledSvg.svelte",
    "../../Svg.svelte",
    "../../App.svelte",
    "../../choromap.svelte",
    "../../map.svelte",
    "../../search_table.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport { setContext } from 'svelte';\n\timport { writable, derived } from 'svelte/store';\n\n\timport makeAccessor from './utils/makeAccessor.js';\n\timport filterObject from './utils/filterObject.js';\n\timport calcExtents from './lib/calcExtents.js';\n\timport calcDomain from './helpers/calcDomain.js';\n\timport createScale from './helpers/createScale.js';\n\timport createGetter from './helpers/createGetter.js';\n\timport getRange from './helpers/getRange.js';\n\timport defaultScales from './settings/defaultScales.js';\n\timport defaultReverses from './settings/defaultReverses.js';\n\n\texport let ssr = false;\n\texport let pointerEvents = true;\n\texport let position = 'relative';\n\texport let percentRange = false;\n\n\texport let width = undefined;\n\texport let height = undefined;\n\n\texport let containerWidth = width || 100;\n\texport let containerHeight = height || 100;\n\n\t/* --------------------------------------------\n\t * Parameters\n\t * Values that computed properties are based on and that\n\t * can be easily extended from config values\n\t *\n\t */\n\texport let x = undefined;\n\texport let y = undefined;\n\texport let z = undefined;\n\texport let r = undefined;\n\texport let custom = {};\n\texport let data = [];\n\texport let xDomain = undefined;\n\texport let yDomain = undefined;\n\texport let zDomain = undefined;\n\texport let rDomain = undefined;\n\texport let xNice = false;\n\texport let yNice = false;\n\texport let zNice = false;\n\texport let rNice = false;\n\texport let xReverse = defaultReverses.x;\n\texport let yReverse = defaultReverses.y;\n\texport let zReverse = defaultReverses.z;\n\texport let rReverse = defaultReverses.r;\n\texport let xPadding = undefined;\n\texport let yPadding = undefined;\n\texport let zPadding = undefined;\n\texport let rPadding = undefined;\n\texport let xScale = defaultScales.x;\n\texport let yScale = defaultScales.y;\n\texport let zScale = defaultScales.y;\n\texport let rScale = defaultScales.r;\n\texport let xRange = undefined;\n\texport let yRange = undefined;\n\texport let zRange = undefined;\n\texport let rRange = undefined;\n\texport let padding = {};\n\texport let extents = {};\n\texport let flatData = undefined;\n\n\t/* --------------------------------------------\n\t * Preserve a copy of our passed in settings before we modify them\n\t * Return this to the user's context so they can reference things if need be\n\t * Add the active keys since those aren't on our settings object.\n\t * This is mostly an escape-hatch\n\t */\n\tconst config = {};\n\t$: if (x) config.x = x;\n\t$: if (y) config.y = y;\n\t$: if (z) config.z = z;\n\t$: if (r) config.r = r;\n\t$: if (xDomain) config.xDomain = xDomain;\n\t$: if (yDomain) config.yDomain = yDomain;\n\t$: if (zDomain) config.zDomain = zDomain;\n\t$: if (rDomain) config.rDomain = rDomain;\n\t$: if (xRange) config.xRange = xRange;\n\t$: if (yRange) config.yRange = yRange;\n\t$: if (zRange) config.zRange = zRange;\n\t$: if (rRange) config.rRange = rRange;\n\n\t/* --------------------------------------------\n\t * Make store versions of each parameter\n\t * Prefix these with `_` to keep things organized\n\t */\n\tconst _percentRange = writable();\n\tconst _containerWidth = writable();\n\tconst _containerHeight = writable();\n\tconst _x = writable();\n\tconst _y = writable();\n\tconst _z = writable();\n\tconst _r = writable();\n\tconst _custom = writable();\n\tconst _data = writable();\n\tconst _xDomain = writable();\n\tconst _yDomain = writable();\n\tconst _zDomain = writable();\n\tconst _rDomain = writable();\n\tconst _xNice = writable();\n\tconst _yNice = writable();\n\tconst _zNice = writable();\n\tconst _rNice = writable();\n\tconst _xReverse = writable();\n\tconst _yReverse = writable();\n\tconst _zReverse = writable();\n\tconst _rReverse = writable();\n\tconst _xPadding = writable();\n\tconst _yPadding = writable();\n\tconst _zPadding = writable();\n\tconst _rPadding = writable();\n\tconst _xScale = writable();\n\tconst _yScale = writable();\n\tconst _zScale = writable();\n\tconst _rScale = writable();\n\tconst _xRange = writable();\n\tconst _yRange = writable();\n\tconst _zRange = writable();\n\tconst _rRange = writable();\n\tconst _padding = writable();\n\tconst _flatData = writable();\n\tconst _extents = writable();\n\tconst _config = writable(config);\n\n\t$: _percentRange.set(percentRange);\n\t$: _containerWidth.set(containerWidth);\n\t$: _containerHeight.set(containerHeight);\n\t$: _x.set(makeAccessor(x));\n\t$: _y.set(makeAccessor(y));\n\t$: _z.set(makeAccessor(z));\n\t$: _r.set(makeAccessor(r));\n\t$: _xDomain.set(xDomain);\n\t$: _yDomain.set(yDomain);\n\t$: _zDomain.set(zDomain);\n\t$: _rDomain.set(rDomain);\n\t$: _custom.set(custom);\n\t$: _data.set(data);\n\t$: _xNice.set(xNice);\n\t$: _yNice.set(yNice);\n\t$: _zNice.set(zNice);\n\t$: _rNice.set(rNice);\n\t$: _xReverse.set(xReverse);\n\t$: _yReverse.set(yReverse);\n\t$: _zReverse.set(zReverse);\n\t$: _rReverse.set(rReverse);\n\t$: _xPadding.set(xPadding);\n\t$: _yPadding.set(yPadding);\n\t$: _zPadding.set(zPadding);\n\t$: _rPadding.set(rPadding);\n\t$: _xScale.set(xScale);\n\t$: _yScale.set(yScale);\n\t$: _zScale.set(zScale);\n\t$: _rScale.set(rScale);\n\t$: _xRange.set(xRange);\n\t$: _yRange.set(yRange);\n\t$: _zRange.set(zRange);\n\t$: _rRange.set(rRange);\n\t$: _padding.set(padding);\n\t$: _extents.set(filterObject(extents));\n\t$: _flatData.set(flatData || data);\n\n\t/* --------------------------------------------\n\t * Create derived values\n\t * Suffix these with `_d`\n\t */\n\tconst activeGetters_d = derived([_x, _y, _z, _r], ([$x, $y, $z, $r]) => {\n\t\treturn [\n\t\t\t{ field: 'x', accessor: $x },\n\t\t\t{ field: 'y', accessor: $y },\n\t\t\t{ field: 'z', accessor: $z },\n\t\t\t{ field: 'r', accessor: $r }\n\t\t].filter(d => d.accessor);\n\t});\n\n\tconst padding_d = derived([_padding, _containerWidth, _containerHeight], ([$padding]) => {\n\t\tconst defaultPadding = { top: 0, right: 0, bottom: 0, left: 0 };\n\t\treturn Object.assign(defaultPadding, $padding);\n\t});\n\n\tconst box_d = derived([_containerWidth, _containerHeight, padding_d], ([$containerWidth, $containerHeight, $padding]) => {\n\t\tconst b = {};\n\t\tb.top = $padding.top;\n\t\tb.right = $containerWidth - $padding.right;\n\t\tb.bottom = $containerHeight - $padding.bottom;\n\t\tb.left = $padding.left;\n\t\tb.width = b.right - b.left;\n\t\tb.height = b.bottom - b.top;\n\t\tif (b.width < 0 && b.height < 0) {\n\t\t\tconsole.error('[LayerCake] Target div has negative width and height. Did you forget to set a width or height on the container?');\n\t\t} else if (b.width < 0) {\n\t\t\tconsole.error('[LayerCake] Target div has a negative width. Did you forget to set that CSS on the container?');\n\t\t} else if (b.height < 0) {\n\t\t\tconsole.error('[LayerCake] Target div has negative height. Did you forget to set that CSS on the container?');\n\t\t}\n\t\treturn b;\n\t});\n\n\tconst width_d = derived([box_d], ([$box]) => {\n\t\treturn $box.width;\n\t});\n\n\tconst height_d = derived([box_d], ([$box]) => {\n\t\treturn $box.height;\n\t});\n\n\t/* --------------------------------------------\n\t * Calculate extents by taking the extent of the data\n\t * and filling that in with anything set by the user\n\t */\n\tconst extents_d = derived([_flatData, activeGetters_d, _extents], ([$flatData, $activeGetters, $extents]) => {\n\t\treturn { ...calcExtents($flatData, $activeGetters.filter(d => !$extents[d.field])), ...$extents };\n\t});\n\n\tconst xDomain_d = derived([extents_d, _xDomain], calcDomain('x'));\n\tconst yDomain_d = derived([extents_d, _yDomain], calcDomain('y'));\n\tconst zDomain_d = derived([extents_d, _zDomain], calcDomain('z'));\n\tconst rDomain_d = derived([extents_d, _rDomain], calcDomain('r'));\n\n\tconst xScale_d = derived([_xScale, extents_d, xDomain_d, _xPadding, _xNice, _xReverse, width_d, height_d, _xRange, _percentRange], createScale('x'));\n\tconst xGet_d = derived([_x, xScale_d], createGetter);\n\n\tconst yScale_d = derived([_yScale, extents_d, yDomain_d, _yPadding, _yNice, _yReverse, width_d, height_d, _yRange, _percentRange], createScale('y'));\n\tconst yGet_d = derived([_y, yScale_d], createGetter);\n\n\tconst zScale_d = derived([_zScale, extents_d, zDomain_d, _zPadding, _zNice, _zReverse, width_d, height_d, _zRange, _percentRange], createScale('z'));\n\tconst zGet_d = derived([_z, zScale_d], createGetter);\n\n\tconst rScale_d = derived([_rScale, extents_d, rDomain_d, _rPadding, _rNice, _rReverse, width_d, height_d, _rRange, _percentRange], createScale('r'));\n\tconst rGet_d = derived([_r, rScale_d], createGetter);\n\n\tconst xRange_d = derived([xScale_d], getRange);\n\tconst yRange_d = derived([yScale_d], getRange);\n\tconst zRange_d = derived([zScale_d], getRange);\n\tconst rRange_d = derived([rScale_d], getRange);\n\n\tconst aspectRatio_d = derived([width_d, height_d], ([$aspectRatio, $width, $height]) => {\n\t\treturn $width / $height;\n\t});\n\n\t$: context = {\n\t\tactiveGetters: activeGetters_d,\n\t\twidth: width_d,\n\t\theight: height_d,\n\t\tpercentRange: _percentRange,\n\t\taspectRatio: aspectRatio_d,\n\t\tcontainerWidth: _containerWidth,\n\t\tcontainerHeight: _containerHeight,\n\t\tx: _x,\n\t\ty: _y,\n\t\tz: _z,\n\t\tr: _r,\n\t\tcustom: _custom,\n\t\tdata: _data,\n\t\txNice: _xNice,\n\t\tyNice: _yNice,\n\t\tzNice: _zNice,\n\t\trNice: _rNice,\n\t\txReverse: _xReverse,\n\t\tyReverse: _yReverse,\n\t\tzReverse: _zReverse,\n\t\trReverse: _rReverse,\n\t\txPadding: _xPadding,\n\t\tyPadding: _yPadding,\n\t\tzPadding: _zPadding,\n\t\trPadding: _rPadding,\n\t\tpadding: padding_d,\n\t\tflatData: _flatData,\n\t\textents: extents_d,\n\t\txDomain: xDomain_d,\n\t\tyDomain: yDomain_d,\n\t\tzDomain: zDomain_d,\n\t\trDomain: rDomain_d,\n\t\txRange: xRange_d,\n\t\tyRange: yRange_d,\n\t\tzRange: zRange_d,\n\t\trRange: rRange_d,\n\t\tconfig: _config,\n\t\txScale: xScale_d,\n\t\txGet: xGet_d,\n\t\tyScale: yScale_d,\n\t\tyGet: yGet_d,\n\t\tzScale: zScale_d,\n\t\tzGet: zGet_d,\n\t\trScale: rScale_d,\n\t\trGet: rGet_d\n\t};\n\n\t$: setContext('LayerCake', context);\n</script>\n\n{#if (ssr === true || typeof window !== 'undefined')}\n\t<div\n\t\tclass=\"layercake-container\"\n\t\tstyle=\"\n\t\t\tposition:{position};\n\t\t\t{position === 'absolute' ? 'top:0;right:0;bottom:0;left:0;' : ''}\n\t\t\t{pointerEvents === false ? 'pointer-events:none;' : ''}\n\t\t\"\n\t\tbind:clientWidth={containerWidth}\n\t\tbind:clientHeight={containerHeight}\n\t>\n\t\t<slot\n\t\t\twidth={$width_d}\n\t\t\theight={$height_d}\n\t\t\taspectRatio={$aspectRatio_d}\n\t\t\tcontainerWidth={$_containerWidth}\n\t\t\tcontainerHeight={$_containerHeight}\n\t\t></slot>\n\t</div>\n{/if}\n\n<style>\n\t.layercake-container,\n\t.layercake-container :global(*) {\n\t\tbox-sizing: border-box;\n\t}\n\t.layercake-container {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n</style>\n",
    "<script>\n\timport { getContext } from 'svelte';\n\n\texport let zIndex = undefined;\n\texport let pointerEvents = undefined;\n\n\tlet zIndexStyle = '';\n\t$: zIndexStyle = typeof zIndex !== 'undefined' ? `z-index:${zIndex};` : '';\n\n\tlet pointerEventsStyle = '';\n\t$: pointerEventsStyle = pointerEvents === false ? 'pointer-events:none;' : '';\n\n\tconst { padding } = getContext('LayerCake');\n</script>\n\n<div\n\tclass=\"layercake-layout-html\"\n\tstyle=\"top: {$padding.top}px; right:{$padding.right}px; bottom:{$padding.bottom}px; left:{$padding.left}px;{zIndexStyle}{pointerEventsStyle}\"\n>\n\t<slot></slot>\n</div>\n\n<style>\n\tdiv,\n\tslot {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t}\n</style>\n",
    "<script>\n\timport { getContext } from 'svelte';\n\n\texport let fixedAspectRatio = 1;\n\texport let viewBox = `0 0 100 ${100 / fixedAspectRatio}`;\n\texport let zIndex = undefined;\n\texport let pointerEvents = undefined;\n\n\tlet zIndexStyle = '';\n\t$: zIndexStyle = typeof zIndex !== 'undefined' ? `z-index:${zIndex};` : '';\n\n\tlet pointerEventsStyle = '';\n\t$: pointerEventsStyle = pointerEvents === false ? 'pointer-events:none;' : '';\n\n\tconst { padding } = getContext('LayerCake');\n</script>\n\n<svg\n\t{viewBox}\n\tpreserveAspectRatio=\"none\"\n\tstyle=\"top: {$padding.top}px; right:0px; bottom:0px; left:{$padding.left}px;width:calc(100% - {($padding.left + $padding.right)}px);height:calc(100% - {($padding.top + $padding.bottom)}px);{zIndexStyle}{pointerEventsStyle}\"\n>\n\t<defs>\n\t\t<slot name=\"defs\"></slot>\n\t</defs>\n\n\t<slot></slot>\n</svg>\n\n<style>\n\tsvg {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\toverflow: visible;\n\t}\n\tsvg :global(*) {\n\t\tvector-effect: non-scaling-stroke;\n\t}\n</style>\n",
    "<script>\n\timport { getContext } from 'svelte';\n\n\texport let viewBox = undefined;\n\texport let zIndex = undefined;\n\texport let pointerEvents = undefined;\n\n\tlet zIndexStyle = '';\n\t$: zIndexStyle = typeof zIndex !== 'undefined' ? `z-index:${zIndex};` : '';\n\n\tlet pointerEventsStyle = '';\n\t$: pointerEventsStyle = pointerEvents === false ? 'pointer-events:none;' : '';\n\n\tconst { containerWidth, containerHeight, padding } = getContext('LayerCake');\n</script>\n<svg\n\tclass=\"layercake-layout-svg\"\n\t{viewBox}\n\twidth={$containerWidth}\n\theight={$containerHeight}\n\tstyle=\"{zIndexStyle}{pointerEventsStyle}\"\n>\n\t<defs>\n\t\t<slot name=\"defs\"></slot>\n\t</defs>\n\t<g transform=\"translate({$padding.left}, {$padding.top})\">\n\t\t<slot></slot>\n\t</g>\n</svg>\n\n<style>\n\tsvg {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\toverflow: visible;\n\t}\n</style>\n",
    "<script>\n  import { onMount } from 'svelte';\n\n  import Map from \"./graphics/map.svelte\";\n\n  export let pymChild = {};\n  export let styleNs = false; // serif or san-serif;\n  export let title = \"Paris municipal elections (second round result)\";\n  export let subtitle = \"Anne Hidalgo vote (%) against car ownership (%)\";\n\n\tonMount(() => {\n\t\t\tpymChild.sendHeight();\n  });\n\n</script>\n\n<svelte:head>\n  <title>{title}</title>\n  <link\n  href=\"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700&display=swap\"\n  rel=\"stylesheet\" />\n</svelte:head>\n\n<div class=\"embed-container\" class:styleNs>\n  <Map {title} {subtitle} {pymChild} />\n</div>\n\n<style>\n  .embed-container.styleNs {\n    font-family: \"Source Sans Pro\", serif; /* catch IE not loading fonts */\n  }\n\n  .embed-container {\n    width: 100%;\n    max-width: 900px;\n    box-sizing: border-box;\n  }\n\n  :global(.chart-container) {\n    width: 100%;\n    padding: 8px;\n    border-top: 1px solid black;\n    border-bottom: 1px solid black;\n    box-sizing: border-box;\n    margin-bottom: 8px;\n  }\n\n  :global(.source-text) {\n    color: #607a8a;\n    margin: 8px 0;\n    font-size: 0.75em;\n\t}\n\t\n\t:global(button) {\n\t\tmargin: 4px;\n\t}\n\n  :global(h3) {\n\t\tmargin: 0;\n\t\tpadding: 0;\n  }\n  \n  :global(h4) {\n\t\tmargin: 0;\n    padding: 0;\n    color: #c1002a;\n    font-weight: normal;\n  }\n</style>\n",
    "<script>\n\timport { getContext } from 'svelte';\n\timport * as geo from 'd3-geo';\n\timport { scaleThreshold } from 'd3-scale';\n\timport { Svg, Html } from 'layercake';\n  import { format } from \"d3-format\";\n  import { range, cross } from 'd3-array';\n  const numFormat = format(\",.0f\");\n\n\tconst { data, width, height } = getContext('LayerCake');\n\n\texport let projectionName = 'geoAlbersUsa';\n\n\t/* --------------------------------------------\n\t * Add this in case you want to plot only a subset of the features\n\t * while keeping the zoom on the whole geojson feature set\n\t */\n\texport let features = $data.features;\n\texport let layerData = [];\n\texport let selectedDomain = [0, 50, 100];\n\texport let colors = [\"#fff\", \"#ccc\", \"#000\"];\n  export let mapField = \"lad19cd\";\n  export let dataField = \"code\";\n\texport let fields = [\n\t\t\t{key: \"Area\", value: \"areaName\"},\n\t\t\t{key: \"Deaths\", value: \"value\"},\n\t];\n\texport let legendConfig = {};\n\n\t$: colorScale = scaleThreshold().range(colors).domain(selectedDomain);\n\n\t$: projection = geo[projectionName]()\n\t\t.fitSize([$width, $height], $data);\n\n\t$: geoPath = geo.geoPath(projection);\n\n\t$: getValue = (feature) => {\n\t\tconst lookup = layerData.filter(d => d[dataField] === feature.properties[mapField]);\n\t\tconst { name, value } = lookup.length > 0 ? lookup[0] : { value: 0 };\n\t\treturn fields.map(d => {\n\t\t\treturn {\n\t\t\t\tkey: d.key,\n\t\t\t\tvalue: lookup[0][d.value]\n\t\t\t}\n\t\t})\n\t};\n\n\t$: fillPath = (feature) => {\n\t\tconst lookup = layerData.filter(d => d[dataField] === feature.properties[mapField]);\n\t\tconst { color } = lookup.length > 0 ? lookup[0] : { color: \"#ccc\" };\n\t\treturn color;\n\t};\n\n\tlet tooltipX = 0;\n\tlet tooltipY = 0;\n\tlet tooltipContent = {};\n\n\t$: enter = (feature) => {\n\t\tif(feature) {\n\t\t\tconst d = feature.properties;\n\t\t\tconst point = geoPath.centroid(feature);\n\t\t\ttooltipContent = getValue(feature);\n\t\t\ttooltipX = point[0];\n\t\t\ttooltipY = point[1] + 20;\n\t\t\tvisible = true;\n\t\t}\n\t}\n\n\tfunction exit (feature) {\n\t\tvisible = false;\n\t\ttooltipContent = {};\n\t}\n\n\tlet visible = false;\n\n\tfunction setContents(result) {\n    if (Object.keys(result).length === 0) return '';\n\n\t\treturn `\n\t\t\t${result.map((row, i) => `<div transform=\"translate(0, ${i * 30})\">\n\t\t\t<span style=\"color: #999; width: 85px;\">${row.key}:</span> \n\t\t\t<span>${row.value}${i > 0 ? \"%\" :\"\"}</span></div>`).join('')}`;\n\t}\n\t\n\tconst { n } = legendConfig;\n\tconst k = 24;\n\tconst labels = [\"low\", \"\", \"high\"];\n\tconst title = [\"Car ownership\", \"Election result\"];\n</script>\n\n<Svg>\n\t<g class=\"map-group\">\n\t\t{#each features as feature}\n\t\t\t<path\n\t\t\t\tclass=\"feature-path\"\n\t\t\t\tfill=\"{fillPath(feature)}\"\n\t\t\t\td=\"{geoPath(feature)}\"\n\t\t\t\ton:mouseenter=\"{enter(feature)}\" \n\t\t\t\ton:mouseout=\"{exit(feature)}\"\n\t\t\t>\n\t\t\t</path>\n\t\t{/each}\n\t</g>\n\t<g class=\"legend svelte-1fmz02g\" transform=\"translate({$width - 66},60)\"><g transform=\"translate(-36,-36) rotate(-45 36,36)\">\n\t<marker id=\"arrow_1\" markerHeight=\"10\" markerWidth=\"10\" refX=\"6\" refY=\"3\" orient=\"auto\">\n\t<path d=\"M0,0L9,3L0,6Z\"></path></marker>\n\t<rect width=\"24\" height=\"24\" y=\"48\" fill=\"#e8e8e8\" x=\"0\"></rect>\n\t<rect width=\"24\" height=\"24\" x=\"0\" y=\"24\" fill=\"#b0d5df\">\n<title>Car ownership\nElection result (low)</title>\n</rect><rect width=\"24\" height=\"24\" x=\"0\" y=\"0\" fill=\"#64acbe\">\n<title>Car ownership (high)\nElection result (low)</title>\n</rect><rect width=\"24\" height=\"24\" x=\"24\" y=\"48\" fill=\"#e4acac\">\n<title>Car ownership (low)\nElection result</title>\n</rect><rect width=\"24\" height=\"24\" x=\"24\" y=\"24\" fill=\"#ad9ea5\">\n<title>Car ownership\nElection result</title>\n</rect><rect width=\"24\" height=\"24\" x=\"24\" y=\"0\" fill=\"#627f8c\">\n<title>Car ownership (high)\nElection result</title>\n</rect><rect width=\"24\" height=\"24\" x=\"48\" y=\"48\" fill=\"#c85a5a\">\n<title>Car ownership (low)\nElection result (high)</title>\n</rect><rect width=\"24\" height=\"24\" x=\"48\" y=\"24\" fill=\"#985356\">\n<title>Car ownership\nElection result (high)</title>\n</rect><rect width=\"24\" height=\"24\" x=\"48\" y=\"0\" fill=\"#574249\">\n<title>Car ownership (high)\nElection result (high)</title>\n</rect>\n<line marker-end=\"#arrow_1\" x1=\"0\" x2=\"72\" y1=\"72\" y2=\"72\" stroke=\"black\" stroke-width=\"1.5\"></line><line marker-end=\"#arrow_1\" y2=\"0\" y1=\"72\" stroke=\"black\" stroke-width=\"1.5\"></line><text font-weight=\"bold\" dy=\"0.71em\" transform=\"rotate(90) translate(36,6)\" text-anchor=\"middle\">Car ownership</text><text font-weight=\"bold\" dy=\"0.71em\" transform=\"translate(36,78)\" text-anchor=\"middle\">Election result</text></g></g>\n</Svg>\n\n<div class=\"tooltip\" style=\"display:{visible ? \"block\" : \"none\"}; top: {tooltipY}px; left: {tooltipX}px\">\n\t{@html setContents(tooltipContent)}\n</div>\n\n<style>\n\t.feature-path {\n\t\tstroke: #333;\n\t\tstroke-width: 0.5px;\n\t}\n\n\t.legend {\n\t\tfont-size: 10px;\n\t}\n\n\t.tooltip {\n\t\tfont-size: 0.75em;\n    position: absolute;\n    font-size: 13px;\n    pointer-events: none;\n    border: 1px solid #ccc;\n    background: rgba(255, 255, 255, 0.85);\n    padding: 5px;\n    transition: left 250ms ease-out, top 250ms ease-out;\n\t\tz-index: 15;\n\t\ttop: 16px;\n\t\tleft: 16px;\n\t}\n</style>\n",
    "<script>\n  import { LayerCake, Canvas, Svg, Html } from 'layercake';\n  import { feature } from 'topojson';\n  import { geoMercator } from 'd3-geo';\n  import { scaleQuantile } from 'd3-scale';\n  import { range } from 'd3-array';\n  import { format } from \"d3-format\";\n\n  import geojson from '../data/arrondissements.geo.json';\n  import csvData from '../data/Paris arrondissement data - Sheet1.csv';\n\n  import ChoroMap from './choromap.svelte';\n  import SearchTable from \"./search_table.svelte\";\n\n  export let title = \"Placeholder\";\n  export let subtitle = \"Placeholder\";\n  export let pymChild = {};\n\n  const colors = [\n    \"#e8e8e8\", \"#e4acac\", \"#c85a5a\",\n    \"#b0d5df\", \"#ad9ea5\", \"#985356\",\n    \"#64acbe\", \"#627f8c\", \"#574249\"\n  ];\n\n  const n = Math.floor(Math.sqrt(colors.length));\n  const x = scaleQuantile(csvData.map(d => d.perc_car), range(n));\n  const y = scaleQuantile(csvData.map(d => d.election_result), range(n));\n  const formatNum = format(\",.1f\");\n\n  function getColor(value) {\n    console.log(value);\n    if (!value) return \"#ccc\";\n    let [a, b] = value;\n    return colors[y(b) + x(a) * n];\n  };\n\n  let layerData = csvData.map(d => ({\n    ...d,\n    region_id: +d.region_id,\n    color: getColor([+d.perc_car, +d.election_result]),\n    election_result: formatNum(+d.election_result)\n  }));\n\n  console.log(layerData);\n</script>\n\n<style>\n  .svg-container {\n    width: 100%;\n    height: 600px;\n  }\n  .map-container {\n    position: relative;\n  }\n\n  @media (max-width: 600px) {\n    .svg-container {\n      height: 400px;\n    }\n  }\n</style>\n\n  <div class=\"chart-container\">\n<h3>{title}</h3>\n<h4>Anne Hidalgo vote (%) against car ownership (%)</h4>\n<div class=\"map-container\">\n  <div class=\"svg-container\">\n    <LayerCake\n      data={geojson}\n      custom={{layerData: layerData}}\n    >\n      <ChoroMap\n        projectionName={'geoMercator'}\n        {layerData}\n        {colors}\n        mapField=\"c_ar\"\n        dataField=\"region_id\"\n        fields={[\n          {key: \"Region\", value: \"region_name\"},\n          {key: \"Car ownership\", value: \"perc_car\"},\n          {key: \"Hidalgo vote\", value: \"election_result\"}\n        ]}\n        legendConfig={\n          {n}\n        }\n      />\n    </LayerCake>\n  </div>\n</div>\n<div class=\"source-text\">The central four arrondissements voted as one.<br>Source: <a href=\"https://www.insee.fr/fr/statistiques/2011101?geo=COM-75101\">INSEE</a>. Base map: <a href=\"https://www.data.gouv.fr/en/datasets/arrondissements-1/\">data.gouv.fr</a></div>\n<SearchTable \n  data={layerData}\n  sliceSize={20}\n  {pymChild}\n  headers={[\n    {title: \"Arrondissement\", key: \"region_id\"},\n    {title: \"Name\", key: \"region_name\"},\n    {title: \"Car ownership (%)\", key: \"perc_car\"},\n    {title: \"Hidalgo vote (%)\", key: \"election_result\"}\n  ]}\n/>\n</div>",
    "<script>\n\timport { getContext, createEventDispatcher } from 'svelte';\n  import { format } from \"d3-format\";\n\n  export let pymChild = {};\n\n\tconst dispatch = createEventDispatcher();\n\n\tfunction setSearch() {\n    searchTerm = event.target.value;\n  \n\t\tdispatch('message', {\n\t\t\ttext: searchTerm,\n\t\t});\n\t}\n  const defNum = format(\",.0f\");\n\n  export let data = [\n    {key: \"1979\", value: 2},\n    {key: \"1983\", value: 18}\n  ];\n  export let headers = Object.keys(data[0]).map(d => ({key: d, title: d}));\n  export let sortField = \"value\";\n  export let keyField = \"key\";\n  export let keys = data.map(d => d[keyField]);\n  export let tableId = \"key-list\";\n  export let enableSearch = false;\n  export let defaultOpen = false;\n  export let searchTerm = \"\";\n  export let autoSort = true;\n  export let sliceSize = 10;\n  const sliceMid = sliceSize / 2;\n\n  function updateHeight() {\n    setTimeout(() => {\n      pymChild.sendHeight()\n    }, 50);\n  }\n\n  function doSort(b, a) {\n    if(autoSort) {\n      return b[sortField] - a[sortField]\n    }\n  }\n\n  data = data.sort(doSort);\n\n  $: searchIdx = data.map(d => d[keyField]).indexOf(searchTerm);\n  $: filteredData = (searchTerm === \"\" || searchIdx < sliceMid) ? data.slice(0, sliceSize) : data.slice(searchIdx - sliceMid, searchIdx + sliceMid);\n</script>\n\n<details on:click={() => updateHeight()} open={defaultOpen === true ? 'open' : ''}>\n<summary style=\"{defaultOpen === true ? \"display: none;\" : \"\"}\"><span>See table</span></summary>\n{#if enableSearch}\n<input bind:value={searchTerm} on:change={(evt) => setSearch(evt)} list=\"{tableId}\"><button on:click={() => (searchTerm = \"\")}>Clear</button>\n<datalist id=\"{tableId}\">\n  {#each keys as key}\n    <option value=\"{key}\">{key}</option>\n  {/each}\n</datalist>\n{/if}\n<table>\n  <thead>\n    <tr>\n      {#each headers as header}\n      <td class={header.type === \"number\" || header.key === \"value\" ? \"number\" : \"\"}>{header.title}</td>\n      {/each}\n    </tr>\n  </thead>\n  {#each filteredData.sort(doSort) as row}\n    <tr class=\"{row[keyField] === searchTerm ? \"bold\" : \"\"}\">\n      {#each headers as header}\n        <td class={header.type === \"number\" || header.key === \"value\" ? \"number\" : \"\"}>\n          {#if row[header.key] === \"null\"}\n            No data\n          {/if}\n          {#if row[header.key] !== \"null\"}\n            {(header.type === \"number\") ? defNum(row[header.key]) : row[header.key]}\n          {/if}\n        </td>\n      {/each}\n    </tr>\n  {/each}\n</table>\n</details>\n\n<style>\n  table {\n    width: 100%;\n    border-collapse: collapse;\n  }\n\n  tr:nth-child(odd) {\n    background: #e7efff;\n  }\n\n  thead {\n    font-weight: bold;\n  }\n\n  td {\n    padding: 2px 4px;\n    max-width: 25%;\n  }\n\n  .bold {\n    font-weight: bold;\n  }\n\n  .number {\n    text-align: right;\n  }\n\n  summary {    \n    width: max-content;\n    border: 1px solid #333;\n    background-color: #f4f4f4;\n    padding: 0 4px;\n  }\n  span {\n    padding: 4px;\n    display: inline-block;\n  }\n\n  details {\n    position: relative;\n    top: -30px;\n  }\n\n  summary {\n    float: right;\n  }\n\n  @media (max-width: 600px) {\n    summary {\n      float: none;\n    }\n\n    details {\n      top: 0;\n    }\n  }\n</style>"
  ],
  "names": [],
  "mappings": "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"
}